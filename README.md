# Cars API

## Описание проекта

Cars API — это RESTful API для управления информацией об автомобилях, построенный с использованием принципов чистой архитектуры. Проект предоставляет надежную аутентификацию и авторизацию пользователей с использованием JWT-токенов.

## Технологический стек

- **Python 3.12+**
- **FastAPI** — быстрый и современный веб-фреймворк
- **PostgreSQL** — реляционная база данных
- **SQLAlchemy** — ORM для работы с базой данных
- **Alembic** — инструмент для миграций базы данных
- **JWT** — для аутентификации и авторизации
- **Pydantic** — для валидации данных и управления настройками
- **Docker** — для контейнеризации приложения

## Архитектура проекта

Проект построен с использованием принципов чистой архитектуры и состоит из следующих слоев:

- **Interface** — содержит контроллеры API, схемы данных и зависимости
- **Core** — содержит бизнес-логику и доменные модели
- **Infrastructure** — содержит репозитории и модели данных

## Установка и запуск

### Предварительные требования

- Python 3.12 или выше
- PostgreSQL
- Виртуальное окружение Python

### Шаги по установке

1. Клонируйте репозиторий:

```bash
git clone https://github.com/username/cars_v2.0.git
cd cars_v2.0
```

2. Создайте и активируйте виртуальное окружение:

```bash
python -m venv .venv
source .venv/bin/activate  # Linux/MacOS
# или
.venv\Scripts\activate  # Windows
```

3. Установите зависимости:

```bash
pip install -r requirements.txt
```

4. Настройте переменные окружения (или используйте файл `.env`):

```bash
cp src/.env.example src/.env
# Отредактируйте файл .env в соответствии с вашими настройками
```

5. Запустите миграции:

```bash
cd src
alembic upgrade head
```

6. Запустите сервер:

```bash
python main.py
```

После запуска API будет доступен по адресу http://localhost:8010

## Структура проекта

```
src/
├── core/                  # Бизнес-логика и доменные модели
│   ├── entites/           # Доменные модели
│   ├── exceptions.py      # Пользовательские исключения
│   ├── InterfaceRepositories/ # Интерфейсы репозиториев
│   └── services/          # Сервисы бизнес-логики
├── infrastructure/        # Слой инфраструктуры
│   ├── models/            # Модели SQLAlchemy
│   ├── postgres_db.py     # Настройки базы данных
│   └── repositories/      # Реализации репозиториев
├── interface/             # API и веб-интерфейс
│   ├── dependencies.py    # Зависимости FastAPI
│   ├── main.py            # Главное приложение FastAPI
│   ├── routers/           # Маршруты API
│   └── schemas/           # Pydantic-схемы
├── migrations/            # Миграции Alembic
├── alembic.ini            # Конфигурация Alembic
├── logger.py              # Настройка логирования
├── main.py                # Точка входа в приложение
└── settings.py            # Настройки приложения
```

## API эндпоинты

### Аутентификация

- `POST /api/public/auth/login` — Вход в систему
- `GET /api/public/auth/logout` — Выход из системы
- `GET /api/public/auth/refresh` — Обновление JWT-токена

### Пользователи

- `POST /api/secured/user/create` — Создание нового пользователя
- `GET /api/secured/user/get/{user_id}` — Получение информации о пользователе

## Работа с миграциями

Для управления схемой базы данных используется Alembic.

### Создание новой миграции:

```bash
alembic revision --autogenerate -m "описание миграции"
```

### Применение миграций:

```bash
alembic upgrade head
```

### Откат миграции:

```bash
alembic downgrade -1
```

## Разработка и тестирование

### Запуск в режиме разработки:

```bash
python main.py
```

### Доступ к документации API:

После запуска сервера документация API доступна по адресу:

- Swagger UI: http://localhost:8010/docs
- ReDoc: http://localhost:8010/redoc
